
Runner.buttonEvents["btNegativeClick"]=function(pageObj,proxy,pageid){pageObj.buttonNames[pageObj.buttonNames.length]='btNegativeClick';if(!pageObj.buttonEventBefore['btNegativeClick']){pageObj.buttonEventBefore['btNegativeClick']=function(params,ctrl,pageObj,proxy,pageid,rowData,row,submit){var ajax=ctrl;var ctrlDialerAgent=Runner.getControl(pageid,'dialerAgent');var ctrlcallHangup=Runner.getControl(pageid,'callHangup');var ctrlCallStatusID=Runner.getControl(pageid,'callStatusId');var ctrlCallDenialReasonID=Runner.getControl(pageid,'callDenialReasonID');if(ctrlcallHangup.isEmpty()){alert("Σφάλμα! ΔΕΝ έχει προηγηθεί HANGUP!!!");return false;};pageObj.showField('callDenialReasonID');var ctrlCallSubClassificationID=Runner.getControl(pageid,'callSubClassificationID');if(ctrlCallSubClassificationID.getValue()=='1003'){ctrlCallStatusID.setValue(13);ctrlCallStatusID.validate();ctrlCallDenialReasonID.validate();}
var statusID=Number(ctrlCallStatusID.getValue());if(ctrlCallDenialReasonID.isEmpty()){if((statusID==1)||(statusID==13)||(statusID==23)||(statusID==33)){alert("Επιλέξτε ΛΟΓΟ ΑΡΝΗΣΗΣ");ctrlCallDenialReasonID.setFocus();return false;};};params["apicallDispo"]=proxy['agentApiUrl']+
ctrlDialerAgent.getValue()+"&function=external_status&value="+"Neg";alert(params["apicallDispo"]);params["apicallMDial"]=proxy['agentApiUrl']+
ctrlDialerAgent.getValue()+"&function=pause_code&value=MDial";alert(params["apicallMDial"]);alert("going to server");return true;}}
if(!pageObj.buttonEventAfter['btNegativeClick']){pageObj.buttonEventAfter['btNegativeClick']=function(result,ctrl,pageObj,proxy,pageid,rowData,row,params){var ajax=ctrl;var ctrlcallStart=Runner.getControl(pageid,'callStart');var ctrlcallHangup=Runner.getControl(pageid,'callHangup');var ctrlcallEnd=Runner.getControl(pageid,'callEnd');var ctrltalkTime=Runner.getControl(pageid,'talkTime');var ctrltypingTime=Runner.getControl(pageid,'typingTime');var ctrltotalCallTime=Runner.getControl(pageid,'totalCallTime');alert(result["resultApicallDispo"]);alert(result["resultApicallMDial"]);if(ctrlcallEnd.isEmpty()){ctrlcallEnd.setValue(moment());ctrlcallEnd.makeReadonly();ctrltypingTime.setValue((ctrlcallEnd.getValue()-ctrlcallHangup.getValue())/1000);ctrltypingTime.makeReadonly();ctrltotalCallTime.setValue((ctrlcallEnd.getValue()-ctrlcallStart.getValue())/1000);ctrltotalCallTime.makeReadonly();}
sleep(2);alert('will close');window.open('http://www.in.gr','_self').close();;window.close();}}
$('a[id="btNegativeClick"]').each(function(){if($(this).closest('.gridRowAdd').length){return;}
this.id="btNegativeClick"+"_"+Runner.genId();var button_btNegativeClick=new Runner.form.Button({id:this.id,btnName:"btNegativeClick"});button_btNegativeClick.init({args:[pageObj,proxy,pageid]});});};