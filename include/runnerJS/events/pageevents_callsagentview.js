
Runner.pages.PageSettings.addPageEvent('callsAgentView',Runner.pages.constants.PAGE_ADD,"afterPageReady",function(pageObj,proxy,pageid,inlineRow,inlineObject,row){var width=1200;var height=800;window.resizeTo(width,height);window.moveTo(((screen.width-width)/2),((screen.height-height)/2));document.documentElement.scrollTop=0;var ctrlDialerAgent=Runner.getControl(pageid,'dialerAgent');ctrlDialerAgent.makeReadWrite();var ctrlphone=Runner.getControl(pageid,'dialerPhone');var ctrlcallStart=Runner.getControl(pageid,'callStart');var ctrlcallHangup=Runner.getControl(pageid,'callHangup');var ctrlcallEnd=Runner.getControl(pageid,'callEnd');var ctrlCallClassificationId=Runner.getControl(pageid,'callClassificationID');var ctrlCallSubClassificationId=Runner.getControl(pageid,'callSubClassificationID');ctrlphone.makeReadonly();ctrlcallStart.setValue(moment());ctrlcallStart.makeReadonly();var countDownDate=new Date();var x=setInterval(function(){var now=new Date().getTime();var distance=now-countDownDate.getTime();var hours=Math.floor((distance%(1000*60*60*24))/(1000*60*60));var minutes=Math.floor((distance%(1000*60*60))/(1000*60));var seconds=Math.floor((distance%(1000*60))/1000);pageObj.findItem('callTimerText').text(hours+"h "
+minutes+"m "+seconds+"s ");pageObj.findItem('agentStatus').text(getAgentStatus(proxy['userData']));},1000);;});Runner.pages.PageSettings.addPageEvent('callsAgentView',Runner.pages.constants.PAGE_EDIT,"afterPageReady",function(pageObj,proxy,pageid,inlineRow,inlineObject,row){updateOrderTotal(pageObj);});Runner.pages.fieldsEvents["callSubClassificationID_onChangeEvent"]=function(pageObj,pageid,row){if(row){row=new Runner.AjaxRow(pageObj,row);}
var ret,reqParams,ctrl=this,fieldsData={},params={},ajax=new Runner.form.Button({id:'callSubClassificationID_onChangeEvent',btnName:'callSubClassificationID_onChangeEvent'}),before=function(){var ctrlCallSubClassificationId=Runner.getControl(pageid,'callSubClassificationID');if((ctrlCallSubClassificationId.getValue()>=1006)&&(ctrlCallSubClassificationId.getValue()<=1010)){pageObj.showField('productFamilyId');}else
{pageObj.hideField('productFamilyId');}
return false;},after=function(result){ctrl.setValue(result["upper"]);},submit=function(){params["table"]="callsAgentView";params["field"]=ctrl.fieldName;(Runner.controls.ControlStorage.byId(pageid)||[]).forEach(function(ctrl){if(!(ctrl instanceof Runner.controls.MultiUploadField)&&!(ctrl instanceof Runner.controls.FileControl)){fieldsData[ctrl.fieldName]=ctrl.getStringValue();}});reqParams={params:JSON.stringify(params),event:"callSubClassificationID_onChangeEvent",pageType:pageObj.pageType,keys:JSON.stringify(pageObj.keys?pageObj.keys:(row&&row.getKeys())),masterTable:pageObj.masterTable,fieldsData:JSON.stringify(fieldsData)};$.post(Runner.getPageUrl("buttonhandler"),reqParams,function(result){var _result;try{_result=JSON.parse(result);}catch(e){Runner.displayGenericAjaxError(result);}
after.call(ctrl,_result);}).fail(function(jqXHR,textStatus,errorThrown){Runner.displayGenericAjaxError(jqXHR.responseText||textStatus+' '+errorThrown);});submit=function(){};};ajax.submitHandler=submit;ajax.submit=submit;ret=before.call(this);if(ret===false){return;}
submit();};